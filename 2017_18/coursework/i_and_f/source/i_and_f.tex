\documentclass[11pt,a4paper]{scrartcl}
\typearea{12}
\usepackage{graphicx}
\usepackage{pstricks}
\usepackage{listings}
\lstset{language=python}
\pagestyle{headings}
\markright{Computation Neuroscience - coursework 1}
\begin{document}
\subsection*{Coursework 1}

\subsubsection*{Solving differential equations with Euler's method}

The following questions are to help you practise your Python, they are
not to be submitted and will not be marked, instead you can compare to
the model graphs available in the same github folder.

\begin{enumerate}

\item Solve numerically in Python using Euler's method the differential equation
\begin{equation}
\frac{df}{dt}=f^2-3f+e^{-t}
\end{equation}
on the interval $[0,3]$ with time step $\delta t=0.01$ and graph the
solution, taking care to label the axes. Although Python has good
libraries for solving differential equations numerically it would be
useful educationally not to use them for these question.

\item For the problem above try solve with $\delta t=0.01$, $0.1$,
  $0.5$ and one. Plot all the curves on one graph. What is a good
  value of $\delta t$ for this equation.

\end{enumerate}

\subsubsection*{Integrate and fire neurons}

The questions in this section are to be submitted for marking and will
make up $10\%$ of your final mark. In this and next assignments, all
the plots should have axes labels, and if there are multiple graphs on
a plot, the legend (or key) should be included. For each missing label
or legend, 1$\%$ of mark will be subtracted.

Write a brief report, no longer than three pages including the figures
and the comments specified above; submissions exceeding the page limit
will be rejected, I will take a dim view of super-narrow margins or
tiny fonts. Submit it in the pdf format together with the Python code
by the deadline. Remember, provided it is in good time, I am happy to
answer questions about Python and to help debug faulty code.

\begin{enumerate}

\item Simulate an integrate and fire model with the following
  parameters for 1 s: $\tau_m = 10 $ms, $E_L = V_r = -70$ mV, $V_t =
  -40$ mV, $R_m= 10$ M$\Omega$, $I_e = 3.1 $ nA. Use Euler's method
  with timestep $\delta t = 1$ ms. Here $E_L$ is the leak potential,
  $V_r$ is the reset voltage, $V_t$ is the threshold, $R_m$ is the
  membrane resistance, that is one over the conductance, and $\tau_m$
  is the membrane time constant. Plot the voltage as a function of
  time. For simplicity assume that the neuron does not have a
  refractory period after producing a spike. [20\% of marks]. You do
  not need to plot spikes - once membrane potential exceeds threshold,
  simply set the membrane potential to $V_r$.

\item Compute analytically the minimum current $I_e$ required for the
  neuron with the above parameters to produce an action
  potential. [10\% of marks].

\item Simulate the neuron for 1 s for the input current with amplitude
  $I_e$ which is 0.1 [nA] lower than the minimum current computed
  above, and plot the voltage as a functions of time. [15\% marks].

\item Simulate the neuron for 1s for currents ranging from 2 [nA] to 5
  [nA] in steps of 0.1 [nA]. For each amplitude of current count the
  number of spikes produced, that is the firing rate. Plot the firing
  rate as the function of the input current. [15\% of marks]. It is
  possible to calculate this curve analytically; there is no
  requirement that you do this, but you might find it interesting to
  try.

\item Simulate two neurons which have synaptic connections between
  each other, that is the first neuron projects to the second, and the
  second neuron projects to the first. Both model neurons should have
  the same parameters: $\tau_m = 20$ ms, $E_L = -70$ mV $V_r = -80$ mV
  $V_t = -54$ mV $R_mI_e = 18$ mV and their synapses should also have
  the same parameters: $R_m \bar{g}_s = 0.15$, $P = 0.5$, $\tau_s= 10$
  ms; don't get confused by being given $R_m\bar{g}_s$ rather than
  $\bar{g}_s$ on its own, to get $\tau_m$ rather than the capacitance
  on the left hand side of the integrate and fire equation everything
  is multiplied by $R_m$. For simplicity take the synaptic conductance
  to satisfy
\begin{equation}
\tau_s\frac{ds}{dt}=-s
\end{equation}
with a spike arriving causing $s$ to increase by $P$. This is
equivalent to the simple synapse model in the lectures. Simulate two
cases: a) assuming that the synapses are excitatory with $E_s = 0$ mV,
and b) assuming that the synapses are inhibitory with $E_s = -80$
mV. For each simulation set the initial membrane potentials of the
neurons $V$ to different values chosen randomly from between $V_r$ and
$V_t$ and simulate 1 s of activity. For each case plot the voltages of
the two neurons on the same graph (with different colours). [20\% of
  marks].

\item In many real neurons the firing rate falls off after the first
  few spikes. This can be simulated with a slow potassium current. For
  the neuron described in the first question add a slow potassium
  current. This current should have reversal potential $E_K=-80$ mV,
  its conductance should increase by 0.005 $($M$\Omega)^{-1}$ every
  time there is a spike, otherwise it should decay towards zero with
  time constant $\tau=200$ ms. Plot the voltage of this neuron for one
  second. [10\% of marks].

\item This is a slightly more open-ended question. Consider the model
  with coupled neurons, but use an alpha function to model $s(t)$
  rather than the single exponential model. Does this change the
  behaviour? [10\% of marks].

\end{enumerate}

\end{document}

